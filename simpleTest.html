<!DOCTYPE HTML>
<html lang="en">
<head>
	<link rel="stylesheet" href="css/game/main.css" />
	<link rel="stylesheet" href="css/game/background.css" />
	<link rel="stylesheet" href="css/game/sprites.css" />
	<script src="js/jquery-1.4.2.js"></script>
	<script src="js/jquery.text-effects.js"></script>

	<script src="js/game/Canvas.js"></script>
	<script src="js/game/Rectangle.js"></script>
	<script src="js/game/GameObject.js"></script>
	<script src="js/game/InnerBoundaryChecker.js"></script>
	<script src="js/game/OutterBoundaryChecker.js"></script>
	<script src="js/game/MovingGameObject.js"></script>
	<script src="js/game/MoveStrategy.js"></script>
	<script src="js/game/SimpleMoveLeftStrategy.js"></script>
	<script src="js/game/SimpleMoveRightStrategy.js"></script>
	<script src="js/game/Ship.js"></script>
	<script src="js/game/Enemy.js"></script>
	<script src="js/game/Rocket.js"></script>

	<script type="text/javascript">
	
	function GameController(){
		var gameOver = false;
		var canvas;
		var flightArea = new Rectangle(0,0,990,455);
		var ship;
		var enemy;
		var rockets = new Array();
		var testElement = $('<div class="ship"></div>');
		
		this.init = function(){
			$('#canvas').append(testElement);
			canvas = new Canvas($('#canvas'));
			canvas.setWidth(990);
			ship = new Ship(flightArea);
			ship.activate(canvas, 5, 5);
			enemy = new Enemy('enemy');
			enemy.speed = 10;
			enemy.activate(canvas, 10, 200);
			this.startGame();
		}

		this.startGame = function(){
			activateControlKeys();
			startGameLoop();
			gameOver = false;
		}

		var activateControlKeys = function(){
			
			$(document).keydown(function(event){
				if(!gameOver){
					switch(event.which){
						case 37:
							ship.movingLeft = true;
							break;
						case 38:	
							ship.movingUp = true;
							break;
						case 39:
							ship.movingRight = true;
							break; 
						case 40:
							ship.movingDown = true;
							break;
						case 32:
							if(ship.rocketFireable){
								rockets.push(ship.fireRocket());
							}
							ship.rocketFireable = false;
							break;
					}
				}
			});
	
			$(document).keyup(function(event){
				if(!gameOver){
					switch(event.which){
						case 37:
							ship.movingLeft = false;
							break;
						case 38:	
							ship.movingUp = false;
							break;
						case 39:
							ship.movingRight = false;
							break; 
						case 40:
							ship.movingDown = false;
							break;
						case 32:
							ship.rocketFireable = true;
							break;
					}
				}
			});
		}
		
		var startGameLoop = function(){
			setInterval(
				function(){
					testElement.css('left', (testElement.position().left + 6));
					ship.move();
					enemy.move();
					for(var i = 0; rockets.length; i++){
						rockets[i].move();
					}
				}, 
				15
			);
		}

	}
	
	jQuery(function(){
		
		var gameController = new GameController();
		gameController.init();
		
		
		
	});
	</script>
</head>
<body>
	<div id="wrapper">
		<br/>
		<div id="canvas">
			dd
		</div>
	</div>
</body>
</html>
















